<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Run contrasts on SummarizedExperiment data — run_contrasts_se • platjam</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/cosmo/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />


<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Run contrasts on SummarizedExperiment data — run_contrasts_se" />
<meta property="og:description" content="Run contrasts on SummarizedExperiment data" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">platjam</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.33.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="http://github.com/jmw86069/platjam/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Run contrasts on SummarizedExperiment data</h1>
    <small class="dont-index">Source: <a href='http://github.com/jmw86069/platjam/blob/master/R/jam-contrasts.R'><code>R/jam-contrasts.R</code></a></small>
    <div class="hidden name"><code>run_contrasts_se.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Run contrasts on SummarizedExperiment data</p>
    </div>

    <pre class="usage"><span class='fu'>run_contrasts_se</span><span class='op'>(</span>
  <span class='va'>se</span>,
  signalList <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/utils/head.html'>head</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/names.html'>names</a></span><span class='op'>(</span><span class='fu'>assays</span><span class='op'>(</span><span class='va'>se</span><span class='op'>)</span><span class='op'>)</span>, <span class='fl'>1</span><span class='op'>)</span>,
  cutoff_p <span class='op'>=</span> <span class='cn'>NULL</span>,
  cutoff_adjp <span class='op'>=</span> <span class='fl'>0.05</span>,
  cutoff_fold <span class='op'>=</span> <span class='fl'>1.5</span>,
  cutoff_mgm <span class='op'>=</span> <span class='fl'>0</span>,
  cutoff_p_int <span class='op'>=</span> <span class='va'>cutoff_p</span>,
  cutoff_adjp_int <span class='op'>=</span> <span class='va'>cutoff_adjp</span>,
  cutoff_fold_int <span class='op'>=</span> <span class='va'>cutoff_fold</span>,
  confint <span class='op'>=</span> <span class='cn'>FALSE</span>,
  probe_colname <span class='op'>=</span> <span class='cn'>NULL</span>,
  gene_colname <span class='op'>=</span> <span class='st'>"gene_name"</span>,
  idesign <span class='op'>=</span> <span class='cn'>NULL</span>,
  icontrasts <span class='op'>=</span> <span class='cn'>NULL</span>,
  enforce_design_subset <span class='op'>=</span> <span class='cn'>TRUE</span>,
  igenes <span class='op'>=</span> <span class='cn'>NULL</span>,
  isamples <span class='op'>=</span> <span class='cn'>NULL</span>,
  use_voom <span class='op'>=</span> <span class='cn'>FALSE</span>,
  weights <span class='op'>=</span> <span class='cn'>NULL</span>,
  robust <span class='op'>=</span> <span class='cn'>FALSE</span>,
  apply_probe_replicates <span class='op'>=</span> <span class='cn'>FALSE</span>,
  floor_minimum <span class='op'>=</span> <span class='fl'>0</span>,
  floor_value <span class='op'>=</span> <span class='fl'>0</span>,
  fill_na <span class='op'>=</span> <span class='cn'>FALSE</span>,
  na_weight <span class='op'>=</span> <span class='fl'>0</span>,
  return_lmfit <span class='op'>=</span> <span class='cn'>FALSE</span>,
  return_df <span class='op'>=</span> <span class='cn'>TRUE</span>,
  return_dfs <span class='op'>=</span> <span class='cn'>TRUE</span>,
  return_hit_array <span class='op'>=</span> <span class='cn'>TRUE</span>,
  collapse_by_gene <span class='op'>=</span> <span class='cn'>FALSE</span>,
  stat_method <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"limma"</span>, <span class='st'>"NanoStringDiff"</span><span class='op'>)</span>,
  debug <span class='op'>=</span> <span class='fl'>0</span>,
  verbose <span class='op'>=</span> <span class='cn'>FALSE</span>,
  <span class='va'>...</span>
<span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>se</th>
      <td><p><code>SummarizedExperiment</code> object with genes/proteins/probes
in each row, and biological samples in each column.</p></td>
    </tr>
    <tr>
      <th>cutoff_p, cutoff_adjp, cutoff_fold, cutoff_mgm</th>
      <td><p>numeric vectors or
<code>NULL</code> to define the thresholds to apply when defining statistical
hits. When multiple values are supplied, each vector is recycled
to the max length of these vectors. The hit criteria are applied
for the first element in each vector, then the second element in
each vector, and so on.</p></td>
    </tr>
    <tr>
      <th>cutoff_p_int, cutoff_adjp_int, cutoff_fold_int</th>
      <td><p>numeric vectors
applied only to two-way or higher contrasts. For example, one
may want to apply <code>cutoff_adjp=0.01</code> for high stringency for
simple pairwise contrasts, then <code>cutoff_adjp_int=0.05</code> for
less stringent criteria for two-way contrasts, due to the decrease
in statistical power when testing twice as many groups.</p></td>
    </tr>
    <tr>
      <th>confint</th>
      <td><p><code>logical</code> passed to <code><a href='https://rdrr.io/pkg/limma/man/toptable.html'>limma::topTable()</a></code> to indicate
whether it returns upper and lower confidence intervals.</p></td>
    </tr>
    <tr>
      <th>probe_colname, gene_colname</th>
      <td><p><code>character</code> values indicating
the colname in <code>rowData(se)</code> that contains probe or gene information.
Probe values are expected to represent unique probe assays,
or unique transcript identified, or some equivalent definition.
Gene values represent the gene or protein to which each individual
entry is assigned, and is optional except when <code>collapse_by_gene=TRUE</code>.</p></td>
    </tr>
    <tr>
      <th>idesign, icontrasts</th>
      <td><p><code>numeric matrix</code> to define the design and
statistical contrasts. It is recommended that <code>idesign</code> has
rownames that match <code><a href='https://rdrr.io/r/base/colnames.html'>colnames(se)</a></code>; and <code><a href='https://rdrr.io/r/base/colnames.html'>colnames(idesign)</a></code> should
match <code><a href='https://rdrr.io/r/base/colnames.html'>rownames(contrasts)</a></code>. The <code><a href='https://rdrr.io/r/base/colnames.html'>colnames(idesign)</a></code> should not
contain characters that interfere with contrast definition, for
example no <code>"-"</code>, <code>"("</code>, <code>")"</code> characters. The <code><a href='https://rdrr.io/r/base/colnames.html'>colnames(icontrasts)</a></code>
can actually contain these characters, as this function makes
effort to maintain the actual <code><a href='https://rdrr.io/r/base/colnames.html'>colnames(icontrasts)</a></code> in the
output for data integrity.</p></td>
    </tr>
    <tr>
      <th>enforce_design_subset</th>
      <td><p><code>logical</code> indicating whether to use only
the subset of samples represented in the full set of contrasts
provided by <code>icontrasts</code>. For example, if testing only one two-group
contrast from data that contains four groups,
<code>enforce_design_subset=TRUE</code> will first reduce the input data to
those two groups, then will run the limma workflow;
<code>enforce_design_subset=FALSE</code> will keep all four groups, but only
apply the contrast to the two groups. The latter process will use
all four groups in the estimate of variance, which is applied to
the two groups. The former process estimates variance only using
the two groups provided.</p></td>
    </tr>
    <tr>
      <th>igenes, isamples</th>
      <td><p><code>character</code> vectors with optional subset of
genes which should match <code><a href='https://rdrr.io/r/base/colnames.html'>rownames(se)</a></code>, or samples which should
match <code><a href='https://rdrr.io/r/base/colnames.html'>colnames(se)</a></code>. When all samples from a given sample group are
removed, all associated contrasts are also removed.</p></td>
    </tr>
    <tr>
      <th>use_voom</th>
      <td><p><code>logical</code> indicating whether to apply <code><a href='https://rdrr.io/pkg/limma/man/voom.html'>limma::voom()</a></code>
to define a weight matrix, which is used in the subsequent
analysis steps.</p></td>
    </tr>
    <tr>
      <th>weights</th>
      <td><p>optional <code>numeric</code> matrix used in the limma analysis
workflow, for example the output from <code><a href='https://rdrr.io/pkg/limma/man/voom.html'>limma::voom()</a></code>.</p></td>
    </tr>
    <tr>
      <th>robust</th>
      <td><p><code>logical</code> passed to <code><a href='https://rdrr.io/pkg/limma/man/ebayes.html'>limma::eBayes()</a></code> to indicate
whether to apply robust estimate of variance, for example calling
<code>limma::squeezeVars()</code>.</p></td>
    </tr>
    <tr>
      <th>apply_probe_replicates</th>
      <td><p><code>logical</code> indicating whether to combine
probe replicates to one summary result per probe, only when there
are multiple rows that represent the same probe (technical replicates.)
When <code>apply_probe_replicates=TRUE</code> it applies the limma workflow
with <code><a href='https://rdrr.io/pkg/limma/man/dupcor.html'>limma::duplicateCorrelation()</a></code>, which is applied to every subset
of probes with equivalent number of replicates. The set of probes
which are not replicated is analyzed in its own batch, then all
results are combined in the output. When <code>apply_probe_replicates=TRUE</code>
the <code>probe_colname</code> argument should represent a column in
<code>rowData(se)</code> that contains a repeated identifier that represents
the technical replicates.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p><code>list</code> whose contents depend upon arguments:
<code>return_df=TRUE</code> returns one large <code>data.frame</code> with all contrasts
and stat hit flags applied; <code>return_dfs=TRUE</code> returns a <code>list</code> of
<code>data.frames</code> named by contrast name, each include a summary
stat table, with flags indicating stat hit and direction, the
group mean, and max group mean values; <code>return_array=TRUE</code> will
return an <code>array</code> with three dimensions: <code>assay_name</code> (the name
of the assays analyzed from the input <code>se</code> object), <code>contrast_name</code>
with each contrast, and <code>hit_rule</code> with the stat hit rules;
<code>return_lmfit=TRUE</code> will return a <code>list</code> of <code>lmFit</code> as returned
by <code><a href='https://rdrr.io/pkg/limma/man/lmFit.html'>limma::lmFit()</a></code> and <code>limma::fitContrasts()</code>.</p>
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>This function is not yet functional, it is being migrated
from a private set of R functions. Until all required functions
are migrated, this function is not usable.</p>
<p>This function is intended to combine several analysis steps
to test statistical contrasts on data stored in
a <code>SummarizedExperiment</code> object. Because <code>SummarizedExperiment</code>
can store multiple assay data matrix entries, for example
with data normalized by different methods, this function
can also test each assay data and assembles results together
for each comparison.</p><ul>
<li><p>Optionally applies <code>limma-voom</code> workflow.</p></li>
<li><p>Applies statistical thresholds:</p><ul>
<li><p>P-value, adjusted P-value</p></li>
<li><p>fold change</p></li>
<li><p>max group mean (highest mean of groups involved in each contrast)</p></li>
</ul></li>
<li><p>Optionally applies a series of different stat hit thresholds</p></li>
<li><p>Optionally applies stat hits thresholds specific to two-way
contrasts</p></li>
<li><p>Optionally combines results by gene, using <code>collapse_by_gene()</code></p></li>
<li><p>Assembles a hit array, vectors named by gene or probe, whose
values indicate the sign of the direction of statistical hits</p></li>
<li><p>Optionally applies recommended limma workflow for replicate
microarray probe spots, for example <code><a href='https://rdrr.io/pkg/limma/man/dupcor.html'>limma::duplicateCorrelation()</a></code>
which returns one summary value per replicated probe</p></li>
<li><p>Optionally applies a signal floor, replacing values at or below
the floor with the replacement (usually <code>NA</code> or the floor).</p></li>
<li><p>Optionally replaces <code>NA</code> values with an assigned value,
usually <code>0</code> or the same floor value above.</p></li>
</ul>


  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by James M. Ward.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


