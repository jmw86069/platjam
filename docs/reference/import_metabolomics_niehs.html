<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Import metabolomics data from NIEHS file formats — import_metabolomics_niehs • platjam</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/cosmo/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Import metabolomics data from NIEHS file formats — import_metabolomics_niehs"><meta property="og:description" content="Import metabolomics data from NIEHS file formats"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">platjam</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.0.73.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="http://github.com/jmw86069/platjam/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Import metabolomics data from NIEHS file formats</h1>
    <small class="dont-index">Source: <a href="http://github.com/jmw86069/platjam/blob/HEAD/R/platjam-import-metabolomics-niehs.R" class="external-link"><code>R/platjam-import-metabolomics-niehs.R</code></a></small>
    <div class="hidden name"><code>import_metabolomics_niehs.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Import metabolomics data from NIEHS file formats</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">import_metabolomics_niehs</span><span class="op">(</span></span>
<span>  <span class="va">data_path</span>,</span>
<span>  shared_samples_only <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  filter_sample_type <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  curation_txt <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  drop_na_columns <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  drop_na_values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="st">"NA"</span>, <span class="st">"not applicable"</span>, <span class="st">"not specified"</span>, <span class="st">"none"</span><span class="op">)</span>,</span>
<span>  simplify_singlet_columns <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>data_path</dt>
<dd><p><code>character</code> path which contains files as named in
Details.</p></dd>


<dt>shared_samples_only</dt>
<dd><p><code>logical</code> indicating whether to retain
only those samples which are shared across positive and negative
ionization data files. This step also typically removed extraneous
technical QC samples which may not have been included in both
the positive and negative ionization data.</p></dd>


<dt>filter_sample_type</dt>
<dd><p><code>character</code> with optional subset of
sample types to retain. The most useful is
<code>filter_sample_types="sample"</code> which will retain only biological
samples, and will drop all other samples. The commonly observed
values in the column <code>"CORE_SampleType"</code>:</p><ul><li><p><code>"sample"</code>: biological sample</p></li>
<li><p><code>"QC_curve"</code>: calibration curve sample</p></li>
<li><p><code>"blank_system"</code>: negative control blank sample</p></li>
<li><p><code>"&lt;NA&gt;"</code>: empty values where data provided a sample which was
not described in the associated project metadata file. This
typically occurs only for system quality control checks,
such as "SystemSuitability", "wash", "AqX_blank", and "AqX_sample".</p></li>
</ul></dd>


<dt>curation_txt</dt>
<dd><p><code>data.frame</code> passed to <code><a href="curate_se_colData.html">curate_se_colData()</a></code>
in order to include sample annotations. The default uses
identifiers from <code>colnames(se)</code> for each <code>SummarizedExperiment</code>
object.
column headers found in the annotation metadata file.
If <code>curation_txt</code> is not supplied, then values will be split into
columns by <code>_</code> underscore or <code>" "</code> whitespace characters.</p></dd>


<dt>drop_na_columns</dt>
<dd><p><code>logivcal</code> indicating whether to drop columns
in <code>colData</code> or <code>rowData</code> when all values are <code>NA</code>, <code>"NA"</code>,
<code>"not applicable"</code>, or <code>"none"</code>, defined in <code>drop_na_values</code>.</p>
<p>Note that columns with only one non-na value in all fields will
be removed from the <code>colData(se)</code> and stored as metadata as
a single <code>character</code> vector accessible via:
<code>se@metadata$colData_values</code></p></dd>


<dt>drop_na_values</dt>
<dd><p><code>character</code> vector of values considered to
be "na" when <code>drop_na_columns=TRUE</code>.</p></dd>


<dt>simplify_singlet_columns</dt>
<dd><p><code>logical</code> indicating whether to remove
<code>colData(se)</code> columns with only one value, instead storing the
name and value in metadata as a character vector.
This option is enabled by default, and simplifies the resulting
<code>colData(se)</code> so that it only includes columns with two or
more unique values.</p></dd>


<dt>verbose</dt>
<dd><p><code>logical</code> indicating whether to print verbose output.</p></dd>


<dt>...</dt>
<dd><p>additional arguments are ignored.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p><code>list</code> of <code>SummarizedExperiment</code> objects, where the <code>list</code></p>


<p>is defined by the type of ionization ("df_pos", "df_neg"), and
the type of data ("cleaned") in the data filenames.
Typically the result includes:</p><ul><li><p><code>"df_pos_cleaned"</code></p></li>
<li><p><code>"df_neg_cleaned"</code></p></li>
</ul><p>If only one ionization is provided, only one entry will be returned.</p>


<p>For each <code>SummarizedExperiment</code> object:</p><ul><li><p><code>rowData</code> represents metabolite annotations</p></li>
<li><p><code>colData</code> represents sample annotations, optionally including
annotations via a <code>data.frame</code> supplied as <code>curation_txt</code>.</p></li>
<li><p>the slot <code>"metadata"</code> is a <code>list</code> with the following:</p><ul><li><p><code>isample_use</code>: the subset of <code>colnames(se)</code> for which there
was sample metadata found in the metadata file. Some control
samples may not match the full metadata, and will be ignored
when using <code>isamples_Use</code>.</p></li>
<li><p><code>irows_use</code>: all <code>rownames(se)</code> for all measured metabolites.</p></li>
<li><p><code>irows_clean</code>: the <code>rownames(se)</code> for measurement with no
annotation in the column <code>"flag_guidance"</code>.</p></li>
<li><p><code>irows_flagged</code>: the <code>rownames(se)</code> for measurements with
some non-empty annotation in the column <code>"flag_guidance"</code>.</p></li>
</ul></li>
</ul></div>
    <div id="details">
    <h2>Details</h2>
    <p>This import function is specific to NIEHS file formats produced
from their defined analysis workflow. The files typically include
<code>"df_pos"</code> for positive ionization, and <code>"df_neg"</code> for negative
ionization.</p>
<p>Optionally, when the full data processing file is present,
it will be imported alongside the cleaned data described above.
The full data processing imports detailed compound measurement
data, and is expected in one of two formats in the <code>data_path</code> folder:</p><ol><li><p>Files <code>"compounds_pos.txt"</code> and/or <code>"compounds_neg.txt"</code>, or</p></li>
<li><p><code>"1_DataProcessed.zip"</code> which is expected to contain
files <code>"compounds_pos.txt"</code> and/or <code>"compounds_neg.txt"</code> in the archive.</p></li>
</ol><p>The "compounds" data includes important annotations for each measurement,
specifically the type of numeric measurement that is supplied
by the upstream software. These annotations include whether numeric
values were imputed, or measured directly in each sample.</p><div class="section">
<h3 id="sample-metadata">Sample Metadata<a class="anchor" aria-label="anchor" href="#sample-metadata"></a></h3>

<ul><li><p><code>"[project_code]_NIEHS_MCF_metadata.txt"</code>: tab-delimited text file
which contains sample annotations.</p></li>
</ul></div>

<div class="section">
<h3 id="positive-ionization-files">Positive Ionization Files<a class="anchor" aria-label="anchor" href="#positive-ionization-files"></a></h3>

<ul><li><p><code>"df_pos.datamatrix.cleaned.txt"</code>: Tab-delimited text file
containing peak areas.
Features are processed and cleaned by MCF for quality.</p></li>
<li><p><code>"df_pos.datamatrix.cleaned.log10.txt"</code>: As above, but log10 transformed.</p></li>
<li><p><code>"df_pos.datamatrix.cleaned.rowsum.txt"</code>: As above but using
row sum peak areas.</p></li>
<li><p><code>"df_pos.annotation.cleaned.txt"</code>: annotation of each measured metabolite.</p></li>
</ul></div>

<div class="section">
<h3 id="negative-ionization-files">Negative Ionization Files<a class="anchor" aria-label="anchor" href="#negative-ionization-files"></a></h3>

<ul><li><p><code>"df_neg.datamatrix.cleaned.txt"</code>: Tab-delimited text file
containing peak areas.
Features are processed and cleaned by MCF for quality.</p></li>
<li><p><code>"df_neg.datamatrix.cleaned.log10.txt"</code>: As above, but log10 transformed.</p></li>
<li><p><code>"df_neg.datamatrix.cleaned.rowsum.txt"</code>: As above but using
row sum peak areas.</p></li>
<li><p><code>"df_neg.annotation.cleaned.txt"</code>: annotation of each measured metabolite.</p></li>
</ul></div>

    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p>Other jam import functions: 
<code><a href="coverage_matrix2nmat.html">coverage_matrix2nmat</a>()</code>,
<code><a href="deepTools_matrix2nmat.html">deepTools_matrix2nmat</a>()</code>,
<code><a href="frequency_matrix2nmat.html">frequency_matrix2nmat</a>()</code>,
<code><a href="import_lipotype_csv.html">import_lipotype_csv</a>()</code>,
<code><a href="import_nanostring_csv.html">import_nanostring_csv</a>()</code>,
<code><a href="import_nanostring_rcc.html">import_nanostring_rcc</a>()</code>,
<code><a href="import_nanostring_rlf.html">import_nanostring_rlf</a>()</code>,
<code><a href="import_proteomics_PD.html">import_proteomics_PD</a>()</code>,
<code><a href="import_proteomics_mascot.html">import_proteomics_mascot</a>()</code>,
<code><a href="import_salmon_quant.html">import_salmon_quant</a>()</code>,
<code><a href="process_metab_compounds_file.html">process_metab_compounds_file</a>()</code></p></div>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="va">data_path</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/path.expand.html" class="external-link">path.expand</a></span><span class="op">(</span><span class="st">"~/Projects/Rider/metabolomics_jul2023/data"</span><span class="op">)</span>;</span></span>
<span class="r-in"><span><span class="va">se_list</span> <span class="op">&lt;-</span> <span class="fu">import_metabolomics_niehs</span><span class="op">(</span><span class="va">data_path</span><span class="op">)</span>;</span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by James M. Ward.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer></div>

  


  

  </body></html>

